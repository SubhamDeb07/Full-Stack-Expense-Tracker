<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css'rel='stylesheet'>
    <style> body {
        background-image: url(https://media.99images.com/photos/wallpapers/creative-graphics/pastel-green%20android-iphone-desktop-hd-backgrounds-wallpapers-1080p-4k-9gjbe.jpg);
    }
form {
    text-align: center;
    background-size: 0cm;
}
</style>
    <title>Leaderboard</title>
</head>
<body>
    <form>
        <h1 style="color:rgb(251, 252, 251)">Leaderboard</h1>
    </form>
    <button style="width: 250px; height: 35px;  background: rgba(16, 16, 16, 0.463);border: none;border-radius: 40px;position: absolute;right: 13.7cm" id="showLeaderBoard">Show Leaderboard</button>
    <div id="message"></div>
    <ul id="leaderBoard"></ul>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>
    <script>
      window.addEventListener("DOMContentLoaded", (event) => {

const token = localStorage.getItem('token')

axios.get('http://localhost:3000/users/get-user', {headers: {'Authorization': token}})
.then((response)=>{
    console.log(response.data.data)
    if(response.data.ispremiumuser=== true){
        document.getElementById('message').innerHTML =  "<p style='color:red'><strong>premium user</strong></p>"

  
    }
    if(response.data.ispremiumuser=== false || response.data.ispremiumuser=== null ){
        var bt2=document.getElementById('showLeaderBoard')
        bt2.onclick = function (){
            alert('please upgrade to premium to access this feature!')
          
        
    }
    }
   
})
.catch((err)=>{
    console.log(err)
})
showLeaderBoard()


})



        function showLeaderBoard(){
        document.getElementById('showLeaderBoard').onclick= async()=>{
    const token =localStorage.getItem('token')
    const response = await axios.get('http://localhost:3000/premium/showLeaderBoard' , {headers: {"Authorization" : token }})
    console.log(response);

    var leaderboardParentElement = document.getElementById('leaderBoard');
    leaderboardParentElement.innerHTML = `<h1> Leader Board </h1>`
    response.data.forEach((userDetails) => {
        leaderboardDisplay(userDetails)
        
    })
}
function leaderboardDisplay(userDetails){
    var leaderboardParentElement = document.getElementById('leaderBoard');
    childNode= `<l1 id= ${userDetails.id}> Name- ${userDetails.username} Total Expense- ${userDetails.TotalCost || 0} </li><br>`
        leaderboardParentElement.innerHTML =  leaderboardParentElement.innerHTML+ childNode
    }

}
    </script>
    
</body>
</html>